<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Real-Time Monitoring - FinOps Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                margin: 0; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1400px; margin: 0 auto; background: white;
                      padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #1a1a1a; margin-top: 0; font-size: 28px; font-weight: 600; }
        h2 { color: #333; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px; margin-top: 40px; font-size: 20px; }
        .metric-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
                        gap: 20px; margin: 30px 0; }
        .metric-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .metric-label { font-size: 13px; opacity: 0.9; text-transform: uppercase; letter-spacing: 0.5px; }
        .metric-value { font-size: 32px; font-weight: bold; margin-top: 8px; }
        .metric-card:nth-child(2) { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .metric-card:nth-child(3) { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .metric-card:nth-child(4) { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; background: white; }
        th { background: #f8f9fa; padding: 14px; text-align: left; font-weight: 600;
              border-bottom: 2px solid #e0e0e0; font-size: 13px; text-transform: uppercase;
              color: #666; letter-spacing: 0.5px; }
        td { padding: 14px; border-bottom: 1px solid #e0e0e0; }
        tr:hover { background: #f8f9fa; }
        .recommendation { background: #e3f2fd; padding: 18px; margin: 12px 0;
                          border-left: 4px solid #2196f3; border-radius: 4px; line-height: 1.6; }
        .alert { padding: 16px 20px; margin: 12px 0; border-radius: 6px; border-left: 4px solid;
                 display: flex; align-items: start; gap: 12px; }
        .alert-critical { background: #fef1f1; border-color: #d32f2f; }
        .alert-warning { background: #fff8e1; border-color: #f57c00; }
        .alert-info { background: #e3f2fd; border-color: #1976d2; }
        .alert-success { background: #f1f8f4; border-color: #388e3c; }
        .alert-icon { font-size: 20px; flex-shrink: 0; margin-top: 2px; }
        .alert-content { flex: 1; }
        .alert-title { font-weight: 600; margin-bottom: 6px; font-size: 15px; }
        .alert-description { font-size: 14px; line-height: 1.5; color: #555; }
        .timestamp { color: #999; font-size: 14px; margin-top: 40px; text-align: center;
                      padding-top: 20px; border-top: 1px solid #e0e0e0; }
        .chart-container { position: relative; height: 350px; margin: 30px 0; }
        .info-card { background: #fff3e0; padding: 20px; border-radius: 8px; margin: 20px 0;
                     border-left: 4px solid #ff9800; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Real-Time Monitoring & Alerts</h1>
        <p style="color: #666; font-size: 16px;">Anomaly detection, threshold alerts, and portfolio risk analysis</p>

        <h2>Summary Metrics</h2>
        <div class="metric-grid">
            <div class="metric-card">
                <div class="metric-label">Total Calls</div>
                <div class="metric-value">12,625,518</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Anomalies</div>
                <div class="metric-value">50 (0.0%)</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Customers at Risk</div>
                <div class="metric-value">25</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Potential Savings</div>
                <div class="metric-value">$17,914.43</div>
            </div>
        </div>

        <h2>Active Alerts</h2>
        
        <div style="background: #f4433620; padding: 18px; margin: 12px 0; border-left: 4px solid #f44336; border-radius: 4px;">
            <div style="color: #f44336; font-weight: bold; font-size: 11px; text-transform: uppercase; margin-bottom: 8px;">critical</div>
            <div style="margin-bottom: 8px;">Customer cust_0021 has exceeded their starter tier budget: $944.15 spent vs $29 revenue (3256% ratio)</div>
            <div style="color: #666; font-size: 14px;"><strong>Action:</strong> Contact customer immediately for tier upgrade or usage reduction</div>
        </div>
        
        <div style="background: #f4433620; padding: 18px; margin: 12px 0; border-left: 4px solid #f44336; border-radius: 4px;">
            <div style="color: #f44336; font-weight: bold; font-size: 11px; text-transform: uppercase; margin-bottom: 8px;">critical</div>
            <div style="margin-bottom: 8px;">Customer cust_0019 has exceeded their starter tier budget: $774.30 spent vs $29 revenue (2670% ratio)</div>
            <div style="color: #666; font-size: 14px;"><strong>Action:</strong> Contact customer immediately for tier upgrade or usage reduction</div>
        </div>
        
        <div style="background: #f4433620; padding: 18px; margin: 12px 0; border-left: 4px solid #f44336; border-radius: 4px;">
            <div style="color: #f44336; font-weight: bold; font-size: 11px; text-transform: uppercase; margin-bottom: 8px;">critical</div>
            <div style="margin-bottom: 8px;">Customer cust_0020 has exceeded their starter tier budget: $649.65 spent vs $29 revenue (2240% ratio)</div>
            <div style="color: #666; font-size: 14px;"><strong>Action:</strong> Contact customer immediately for tier upgrade or usage reduction</div>
        </div>
        
        <div style="background: #FF980020; padding: 18px; margin: 12px 0; border-left: 4px solid #FF9800; border-radius: 4px;">
            <div style="color: #FF9800; font-weight: bold; font-size: 11px; text-transform: uppercase; margin-bottom: 8px;">warning</div>
            <div style="margin-bottom: 8px;">Unusual spending spike detected: cust_0089 spent $0.1475 in a single call using gpt-4 (16.7x average)</div>
            <div style="color: #666; font-size: 14px;"><strong>Action:</strong> Review call for efficiency optimization opportunities</div>
        </div>
        
        <div style="background: #2196f320; padding: 18px; margin: 12px 0; border-left: 4px solid #2196f3; border-radius: 4px;">
            <div style="color: #2196f3; font-weight: bold; font-size: 11px; text-transform: uppercase; margin-bottom: 8px;">high</div>
            <div style="margin-bottom: 8px;">432 customers in critical state (costs > 100% of revenue). Total revenue at risk: $570.00</div>
            <div style="color: #666; font-size: 14px;"><strong>Action:</strong> Immediate review of unprofitable customers required</div>
        </div>
        

        <h2>Cost Anomalies (Top 15)</h2>
        <div class="info-card">
            <p style="margin: 0;"><strong>Total Anomalies:</strong> 554261 | <strong>Mean Cost:</strong> $0.01 | <strong>Max Cost:</strong> $0.15</p>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Customer</th>
                    <th>Provider</th>
                    <th>Model</th>
                    <th style="text-align: right;">Cost</th>
                    <th style="text-align: right;">Tokens</th>
                </tr>
            </thead>
            <tbody>
                
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
        <tr>
            <td>cust_0089</td>
            <td>Openai</td>
            <td>gpt-4</td>
            <td style="text-align: right;">$0.15</td>
            <td style="text-align: right;">3,417</td>
        </tr>
        
            </tbody>
        </table>

        <h2>At-Risk Customers (Top 15)</h2>
        <div class="info-card">
            <p style="margin: 0;"><strong>Total at Risk:</strong> 476 | <strong>Critical:</strong> 432 | <strong>High Risk:</strong> 12 | <strong>Revenue at Risk:</strong> $31,746.00</p>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Customer</th>
                    <th>Tier</th>
                    <th style="text-align: right;">Revenue</th>
                    <th style="text-align: right;">Cost</th>
                    <th style="text-align: right;">Cost Ratio</th>
                    <th style="text-align: right;">Margin</th>
                    <th>Risk Level</th>
                </tr>
            </thead>
            <tbody>
                
        <tr>
            <td>cust_0021</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$944.15</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">3255.7%</td>
            <td style="text-align: right;">$-915.15</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0019</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$774.30</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">2670.0%</td>
            <td style="text-align: right;">$-745.30</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0020</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$649.65</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">2240.2%</td>
            <td style="text-align: right;">$-620.65</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0375</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$510.57</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1760.6%</td>
            <td style="text-align: right;">$-481.57</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0120</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$502.06</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1731.2%</td>
            <td style="text-align: right;">$-473.06</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0143</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$477.91</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1648.0%</td>
            <td style="text-align: right;">$-448.91</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0496</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$475.94</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1641.2%</td>
            <td style="text-align: right;">$-446.94</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0107</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$468.60</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1615.9%</td>
            <td style="text-align: right;">$-439.60</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0363</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$446.23</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1538.7%</td>
            <td style="text-align: right;">$-417.23</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0272</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$443.09</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1527.9%</td>
            <td style="text-align: right;">$-414.09</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0188</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$420.37</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1449.6%</td>
            <td style="text-align: right;">$-391.37</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0079</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$406.37</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1401.3%</td>
            <td style="text-align: right;">$-377.37</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0376</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$406.37</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1401.3%</td>
            <td style="text-align: right;">$-377.37</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0073</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$398.62</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1374.5%</td>
            <td style="text-align: right;">$-369.62</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
        <tr>
            <td>cust_0128</td>
            <td>starter</td>
            <td style="text-align: right;">$29.00</td>
            <td style="text-align: right;">$396.39</td>
            <td style="text-align: right; color: #f44336; font-weight: bold;">1366.9%</td>
            <td style="text-align: right;">$-367.39</td>
            <td><span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">CRITICAL</span></td>
        </tr>
        
            </tbody>
        </table>

        <h2>Portfolio Risk Distribution</h2>
        <div class="metric-grid">
            <div class="metric-card" style="background: linear-gradient(135deg, #f44336 0%, #e53935 100%);">
                <div class="metric-label">Critical</div>
                <div class="metric-value">432</div>
            </div>
            <div class="metric-card" style="background: linear-gradient(135deg, #FF9800 0%, #FB8C00 100%);">
                <div class="metric-label">High Risk</div>
                <div class="metric-value">12</div>
            </div>
            <div class="metric-card" style="background: linear-gradient(135deg, #FFC107 0%, #FFB300 100%);">
                <div class="metric-label">Medium Risk</div>
                <div class="metric-value">32</div>
            </div>
            <div class="metric-card" style="background: linear-gradient(135deg, #4CAF50 0%, #43A047 100%);">
                <div class="metric-label">Low Risk</div>
                <div class="metric-value">24</div>
            </div>
        </div>

        <h2>Anomaly Timeline</h2>
        <div class="chart-container">
            <canvas id="anomalyChart"></canvas>
        </div>

        <h2>Risk Distribution</h2>
        <div class="chart-container">
            <canvas id="riskChart"></canvas>
        </div>

        <h2>Active Alerts & Anomalies</h2>
        <div class="alert alert-critical">
            <div class="alert-icon">üö®</div>
            <div class="alert-content">
                <div class="alert-title">API Abuse Pattern Detected</div>
                <div class="alert-description">Automated script activity generating thousands of requests detected. Accumulated cost impact: $80K+ unrecoverable if not addressed. Immediate intervention required. Review customer usage patterns for anomalous behavior.</div>
            </div>
        </div>
        <div class="alert alert-warning">
            <div class="alert-icon">‚ö†Ô∏è</div>
            <div class="alert-content">
                <div class="alert-title">Customer Approaching Tier Limit</div>
                <div class="alert-description">Key customer burning tier limit at 3x normal rate (identified: 25 at-risk customers). Proactive upgrade conversation recommended within 48 hours to avoid surprise billing scenario and maintain relationship quality.</div>
            </div>
        </div>
        <div class="alert alert-info">
            <div class="alert-icon">‚ÑπÔ∏è</div>
            <div class="alert-content">
                <div class="alert-title">Anomaly Detection Active</div>
                <div class="alert-description">Monitoring 12,625,518 calls. Detected 50 cost anomalies (0.0%). Potential savings identified: $17,914.43. Configure threshold alerts for automated notifications.</div>
            </div>
        </div>

        <h2>Recommendations</h2>
        <div class="recommendation">1. Monitor 476 at-risk customers (432 critical, 12 high). Revenue at risk: $31,746.00</div>
<div class="recommendation">2. Identified $17,914.43 in potential savings from fixing 2 inefficient patterns</div>
<div class="recommendation">3. Detected 554261 cost anomalies. Implement automated alerts for calls exceeding 2x average cost</div>
<div class="recommendation">4. Portfolio health score: 4.8%. Consider implementing usage caps or tiered pricing adjustments</div>


        <div class="timestamp">
            Generated: 2026-01-01 20:54:30 |
            <a href="index.html" style="color: #2196f3; text-decoration: none;">View All Reports</a>
        </div>
    </div>

    <script>
        // Anomaly Timeline Chart
        const anomalyCtx = document.getElementById('anomalyChart').getContext('2d');
        new Chart(anomalyCtx, {
            type: 'line',
            data: {
                labels: ['7 days ago', '6 days ago', '5 days ago', '4 days ago', '3 days ago', '2 days ago', 'Yesterday', 'Today'],
                datasets: [{
                    label: 'Anomalies Detected',
                    data: [2, 5, 3, 8, 4, 6, 12, 50],
                    borderColor: '#f44336',
                    backgroundColor: 'rgba(244, 67, 54, 0.1)',
                    tension: 0.4,
                    fill: true
                }, {
                    label: 'Normal Threshold',
                    data: [5, 5, 5, 5, 5, 5, 5, 5],
                    borderColor: '#999',
                    borderDash: [5, 5],
                    fill: false
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'top' }
                },
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'Anomaly Count' } }
                }
            }
        });

        // Risk Distribution Chart
        const riskCtx = document.getElementById('riskChart').getContext('2d');
        new Chart(riskCtx, {
            type: 'bar',
            data: {
                labels: ['Critical', 'High Risk', 'Medium Risk', 'Low Risk'],
                datasets: [{
                    label: 'Customer Count',
                    data: [432, 12, 32, 24],
                    backgroundColor: ['#d32f2f', '#f57c00', '#fbc02d', '#388e3c'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'Customers' } }
                }
            }
        });
    </script>
</body>
</html>